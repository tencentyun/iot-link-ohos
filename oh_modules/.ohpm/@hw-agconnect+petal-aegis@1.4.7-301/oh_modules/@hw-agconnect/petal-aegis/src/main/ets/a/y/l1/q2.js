import { AegisError } from "../../s/t"; import { AegisErrorCode } from "../../s/u"; import { KeyManager } from "../z/b1"; import { SignerInfoCenter } from "./l2"; import { VerifyHandler } from "./n2"; export class HuksVerifyHandler extends VerifyHandler { constructor(y7, keyAlias) { super(y7); this.keyAlias = keyAlias; } async prepare() { let x7 = SignerInfoCenter.load(this.signAlg); if (!await KeyManager.hasHuksKey(x7.keyType, this.keyAlias)) { throw new AegisError(AegisErrorCode.VERIFY_ERROR, `verify with a non-exist huks key:${this.keyAlias}`); } } } 