import { AegisError } from "../../s/t"; import { AegisErrorCode } from "../../s/u"; import { Logger } from "../../c2/d2"; import { DataProcessor } from "../h2"; export class SignHandler extends DataProcessor { constructor(k8) { super(); this.signAlg = k8; } async prepare() { } async to() { try { await this.prepare(); let signature = await this.doSign(); this.clear(); return signature; } catch (err) { let errMsg = `sign failed, code:${err.code} msg:${err.message}`; Logger.error(errMsg); throw new AegisError(AegisErrorCode.SIGN_ERROR, errMsg); } } } 